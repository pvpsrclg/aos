slip14

Q.1) Display all the files from current directory whose size is greater that n Bytes 
Where n is accept from user. 
---------------------------------------
#include <stdio.h> 
#include <sys/stat.h> 
#include <dirent.h> 
#include <string.h> 
int main() { 
long n; 
printf("Enter the size in bytes: "); 
scanf("%ld", &n); 
DIR *dir = opendir("."); 
if (!dir) { 
perror("opendir"); 
return 1; 
} 
struct dirent *entry; 
struct stat st; 
printf("Files with size greater than %ld bytes:\n", n); 
    while ((entry = readdir(dir)) != NULL) { 
        
        if (stat(entry->d_name, &st) == 0 && S_ISREG(st.st_mode)) { 
            if (st.st_size > n) { 
                printf("%s (%ld bytes)\n", entry->d_name, (long)st.st_size); 
            } 
        } 
    } 
    closedir(dir); 
    return 0; 
} 
--------------------------------------------------------------- 
Q.2) Write a C program to find file properties such as inode number, number of hard 
link, File permissions, File size, File access and modification time and so on of a given 
f
 ile using stat() system call. [20 Marks ] 
----------------------------------------------------------------
#include <stdio.h> 
#include <stdlib.h> 
#include <sys/stat.h> 
#include <pwd.h> 
#include <grp.h> 
#include <time.h> 
void print_permissions(mode_t mode) { 
printf("Permissions: "); 
printf( (S_ISDIR(mode)) ? "d" : "-"); 
printf( (mode & S_IRUSR) ? "r" : "-"); 
printf( (mode & S_IWUSR) ? "w" : "-"); 
printf( (mode & S_IXUSR) ? "x" : "-"); 
printf( (mode & S_IRGRP) ? "r" : "-"); 
printf( (mode & S_IWGRP) ? "w" : "-"); 
printf( (mode & S_IXGRP) ? "x" : "-"); 
printf( (mode & S_IROTH) ? "r" : "-"); 
printf( (mode & S_IWOTH) ? "w" : "-"); 
printf( (mode & S_IXOTH) ? "x" : "-"); 
printf("\n"); 
} 
int main(int argc, char *argv[]) { 
if (argc != 2) { 
printf("Usage: %s <filename>\n", argv[0]); 
return 1; 
} 
struct stat st; 
if (stat(argv[1], &st) == -1) { 
perror("stat"); 
return 1; 
} 
printf("File: %s\n", argv[1]); 
printf("Inode number        
: %lu\n", (unsigned long)st.st_ino); 
printf("Number of hard links: %lu\n", (unsigned long)st.st_nlink); 
print_permissions(st.st_mode); 
printf("File size          
 : %ld bytes\n", (long)st.st_size); 
struct passwd *pw = getpwuid(st.st_uid); 
struct group  *gr = getgrgid(st.st_gid); 
printf("Owner UID: %u (%s)\n", st.st_uid, pw ? pw->pw_name : "Unknown"); 
printf("Group GID: %u (%s)\n", st.st_gid, gr ? gr->gr_name : "Unknown"); 
printf("Last access time    : %s", ctime(&st.st_atime)); 
printf("Last modification   : %s", ctime(&st.st_mtime)); 
printf("Last status change  : %s", ctime(&st.st_ctime)); 
return 0; 
} 
